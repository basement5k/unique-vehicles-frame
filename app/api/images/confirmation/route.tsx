import { NextRequest } from 'next/server';\nimport { ImageResponse } from 'next/og';\nimport { getSessionData } from '@/lib/utils';\n\nexport const runtime = 'edge';\n\nexport async function GET(req: NextRequest) {\n  try {\n    const searchParams = req.nextUrl.searchParams;\n    const sessionId = searchParams.get('sessionId');\n\n    if (!sessionId) {\n      return new Response('Missing session ID', { status: 400 });\n    }\n\n    const sessionData = await getSessionData(sessionId);\n    if (!sessionData || !sessionData.imageUrl || !sessionData.vehicleDetails) {\n      return new Response('Invalid session data', { status: 400 });\n    }\n\n    const { description, vehicleType, location } = sessionData.vehicleDetails;\n\n    return new ImageResponse(\n      (\n        <div\n          style={{\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'center',\n            width: '100%',\n            height: '100%',\n            backgroundColor: 'white',\n            padding: 30,\n          }}\n        >\n          <div\n            style={{\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: 'center',\n              width: '100%',\n              height: '100%',\n            }}\n          >\n            <div\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                backgroundColor: '#8A63D2',\n                color: 'white',\n                width: '100%',\n                padding: '12px 0',\n                fontSize: 24,\n                fontWeight: 'bold',\n                marginBottom: 16,\n                borderRadius: 8,\n              }}\n            >\n              Confirm Vehicle Details\n            </div>\n\n            <div style={{ display: 'flex', width: '100%', gap: '20px' }}>\n              {/* Image on the left */}\n              <div\n                style={{\n                  display: 'flex',\n                  justifyContent: 'center',\n                  width: '45%',\n                  height: '350px',\n                  position: 'relative',\n                  borderRadius: 8,\n                  overflow: 'hidden',\n                  border: '1px solid #ddd',\n                }}\n              >\n                {/* eslint-disable-next-line @next/next/no-img-element */}\n                <img\n                  src={sessionData.imageUrl}\n                  alt=\"Vehicle\"\n                  style={{\n                    width: '100%',\n                    height: '100%',\n                    objectFit: 'cover',\n                  }}\n                />\n              </div>\n\n              {/* Details on the right */}\n              <div\n                style={{\n                  display: 'flex',\n                  flexDirection: 'column',\n                  width: '55%',\n                  padding: '16px',\n                  backgroundColor: '#f5f5f5',\n                  borderRadius: 8,\n                  border: '1px solid #ddd',\n                }}\n              >\n                <div style={{ marginBottom: '16px' }}>\n                  <div style={{ fontSize: 16, fontWeight: 'bold', color: '#555', marginBottom: '4px' }}>\n                    Description:\n                  </div>\n                  <div style={{ fontSize: 20, color: '#333' }}>{description || 'N/A'}</div>\n                </div>\n\n                <div style={{ marginBottom: '16px' }}>\n                  <div style={{ fontSize: 16, fontWeight: 'bold', color: '#555', marginBottom: '4px' }}>\n                    Vehicle Type/Model:\n                  </div>\n                  <div style={{ fontSize: 20, color: '#333' }}>{vehicleType || 'N/A'}</div>\n                </div>\n\n                <div style={{ marginBottom: '16px' }}>\n                  <div style={{ fontSize: 16, fontWeight: 'bold', color: '#555', marginBottom: '4px' }}>\n                    Location:\n                  </div>\n                  <div style={{ fontSize: 20, color: '#333' }}>{location || 'N/A'}</div>\n                </div>\n\n                <div\n                  style={{\n                    marginTop: 'auto',\n                    padding: '12px',\n                    backgroundColor: '#e6f7ff',\n                    borderRadius: 6,\n                    fontSize: 16,\n                    color: '#333',\n                    border: '1px solid #91d5ff',\n                  }}\n                >\n                  Press \"Submit\" to share this vehicle sighting with the community!\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      ),\n      {\n        width: 1200,\n        height: 630,\n      }\n    );\n  } catch (error) {\n    console.error('Error generating confirmation image:', error);\n    return new Response('Error generating confirmation', { status: 500 });\n  }\n}